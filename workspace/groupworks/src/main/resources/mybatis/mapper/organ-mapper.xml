<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="OrganMapper">

<!-- 조직도 생성 -->
	<insert id="insert">
		INSERT INTO ORGAN(
		    ORG_NO
		    , MEMBER_NO
		    , PROFILE
		    , DEPARTMENT
		    , POSITION
		    , NAME
		    , TEL
		    )
		VALUES (
		    SEQ_ORGAN_NO.NEXTVAL
		    , #{memberNo}
		    , #{profile}
		    , #{department}
		    , #{position}
		    , #{name}
		    , #{tel}
		    )	
	</insert>
	
<!-- 	전체 목록 조회 -->
<!-- 	<select id="list" resultType="com.groupworks.app.organ.vo.OrganVo"> -->
<!-- 		SELECT -->
<!-- 		    ORG_NO -->
<!-- 		    , MEMBER_NO -->
<!-- 		    , PROFILE -->
<!-- 		    , DEPARTMENT -->
<!-- 		    , POSITION -->
<!-- 		    , NAME -->
<!-- 		    , TEL -->
<!-- 		FROM ORGAN -->
<!-- 		WHERE DELETE_YN = 'N' -->
<!-- 		ORDER BY ORG_NO DESC -->
<!-- 	</select> -->
	<select id="list" resultType="com.groupworks.app.organ.vo.OrganVo">
		SELECT
		    NO
		    , NAME
		    , DEPART_NO
		    , POSITION_NO
		    , TEL
		    , EMAIL
		FROM MEMBER
		WHERE DEL_YN = 'N'
		AND DEPART_NO = #{departNo}
		ORDER BY NO DESC
	</select>
	
	<select id="detail" resultType="com.groupworks.app.organ.vo.OrganVo">
		SELECT
		    ORG_NO
		    , MEMBER_NO
		    , PROFILE
		    , DEPARTMENT
		    , POSITION
		    , NAME
		    , TEL
		FROM ORGAN
		WHERE MEMBER_NO = #{memberNo}
		AND DELETE_YN = 'N'
	</select>
	
<!-- 	수정 -->
	<update id="edit">
		UPDATE ORGAN
		SET
		<trim prefixOverrides=",">
		<if test=" memberNo != null and memberNo != '' ">
			MEMBER_NO = #{memberNo}
		</if>
		<if test=" profile != null and profile != '' ">
		    , PROFILE = #{profile}
		</if>
		<if test=" department != null and department != '' ">
		    , DEPARTMENT = #{department}
	    </if>
	    <if test=" position != null and position != '' ">
		    , POSITION = #{position}
	    </if>
	    <if test=" name != null and name != '' ">
		    , NAME = #{name}
	    </if>
	    <if test=" tel != null and tel != '' ">
		    , TEL = #{tel}
	    </if>
	    </trim>
		WHERE ORG_NO = #{orgNo}
		AND DELETE_YN = 'N'
	</update>
	
<!-- 	삭제 -->
	<update id="delete">
		UPDATE ORGAN
		SET DELETE_YN = 'Y'
		WHERE ORG_NO = #{orgNo}
	</update>
</mapper>










